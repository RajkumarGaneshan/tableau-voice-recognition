
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<title>Voice regcognition Test</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Creating Tabitha">
		<meta name="author" content="Jeffrey Shaffer">

		<script src="annyang.min.js"></script> <!-- Voice Recognition -->
		<script src="responsivevoice.js"></script> <!-- Voice Response -->
		
		<script src="https://public.tableausoftware.com/javascripts/api/tableau-2.min.js " type="text/javascript"></script> 

</head>	

<body onload=initializeViz();>
<h1>"MERINO GROUP"</h1>
Say: <i>"Any RegionName  (Example: Select North") and "Branch"</i>
<br>
<br>
<center><div id='tableauViz'></div></center>

<script>
if (annyang) {
  // These are the voice commands in quotes followed by the function
  var commands = {
  	'Select Central': function() { selectCentral(); responsiveVoice.speak('selecting Central'); },
 	'Select East': function() { selectEast(); responsiveVoice.speak('selecting East'); },
 	'Select North': function() { selectNorth(); responsiveVoice.speak('selecting North'); },
 	'Select South': function() { selectSouth(); responsiveVoice.speak('selecting South'); },
	'Select Chennai': function() { selectChennai(); responsiveVoice.speak('selecting Chennai'); },
	'Select Andhra Pradesh': function() { selectAndhraPradesh(); responsiveVoice.speak('selecting Andhra Pradesh'); },
	'start over': function() { startover(); responsiveVoice.speak('starting over'); },
	'Navigate to landing page': function() { activateSheetAsync(); responsiveVoice.speak('Taking you to Landing Page'); },
	'Go to Summary view': function() { activateSheetAsync1(); responsiveVoice.speak('Taking you to Summary View'); },
	'Go to Analysis view': function() { activateSheetAsync2(); responsiveVoice.speak('Taking you to Analysis View'); },
	'Go to Overview': function() { activateSheetAsync3(); responsiveVoice.speak('Taking you to  OverView'); },
	'Go to Outlet Analysis': function() { activateSheetAsync4(); responsiveVoice.speak('Taking you to Outlet Analysis'); },
	'Export': function() { Export(); responsiveVoice.speak('Export'); }
 };
  
  // Add commands to annyang
  annyang.addCommands(commands);
  
  // Start listening.
  annyang.start();
}
</script>

<script>
var viz, workbook, activeSheet, Worksheet, worksheet;
function initializeViz(){

var placeholderDiv = document.getElementById("tableauViz");

var url = "https://prod-apnortheast-a.online.tableau.com/t/demositeforpartners/views/MerinoFinalPOCV1/Analysis1";
var options = {
   width: "1300",   
   height: "869",
   hideTabs: true,
   hideToolbar: true,
  onFirstInteractive: function () {
  workbook = viz.getWorkbook();
  activeSheet = workbook.getActiveSheet();
}
};
  viz = new tableauSoftware.Viz(placeholderDiv, url, options);
}

//Tabitha says hello
responsiveVoice.speak('Hi. My name is Tabitha. How may I help you?');

//Make Character selection
function selectCentral()
	{
	activeSheet.getWorksheets()[2].applyFilterAsync('Region', 'Central', 'REPLACE'); 
	}

function selectEast()
	{
	activeSheet.getWorksheets()[2].applyFilterAsync('Region', 'East', 'REPLACE'); 
	}

function selectNorth()
	{
	activeSheet.getWorksheets()[2].applyFilterAsync('Region', 'North', 'REPLACE'); 
	}	
	
function selectSouth()
	{
	activeSheet.getWorksheets()[2].applyFilterAsync('Region', 'South', 'REPLACE'); 
	}	

function selectChennai()
	{
	activeSheet.getWorksheets()[2].applyFilterAsync('Branch', 'Chennai', 'REPLACE'); 
	}	

function selectAndhraPradesh()
	{
	activeSheet.getWorksheets()[2].applyFilterAsync('Branch', 'Andhra Pradesh', 'REPLACE'); 
	}
	
	
	
//Start Viz Over
function startover()
	{

	viz.revertAllAsync();
	}
function Export()
	{

	viz.showExportPDFDialog();
	}

function activateSheetAsync()
       {
	viz.getWorkbook().activateSheetAsync(0);
       }

function activateSheetAsync1()
       {
	viz.getWorkbook().activateSheetAsync(1);
       }

function activateSheetAsync2()
       {
	viz.getWorkbook().activateSheetAsync(2);
       }
function activateSheetAsync3()
       {
	viz.getWorkbook().activateSheetAsync(5);
       }
function activateSheetAsync4()
       {
	viz.getWorkbook().activateSheetAsync(6);
       }
</script>

</body>
</html>		
		
		
